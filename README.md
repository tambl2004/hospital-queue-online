# ğŸ¥ Há»† THá»NG QUáº¢N LÃ Bá»†NH VIá»†N ONLINE

Há»‡ thá»‘ng quáº£n lÃ½ bá»‡nh viá»‡n trá»±c tuyáº¿n vá»›i Ä‘áº§y Ä‘á»§ chá»©c nÄƒng Ä‘áº·t lá»‹ch khÃ¡m, quáº£n lÃ½ hÃ ng Ä‘á»£i, thá»‘ng kÃª vÃ  bÃ¡o cÃ¡o. Há»‡ thá»‘ng há»— trá»£ 3 vai trÃ² chÃ­nh: **Admin**, **BÃ¡c sÄ©**, vÃ  **Bá»‡nh nhÃ¢n**.

## ğŸ“‹ Má»¥c lá»¥c

- [TÃ­nh nÄƒng chÃ­nh](#-tÃ­nh-nÄƒng-chÃ­nh)
- [CÃ´ng nghá»‡ sá»­ dá»¥ng](#-cÃ´ng-nghá»‡-sá»­-dá»¥ng)
- [Cáº¥u trÃºc dá»± Ã¡n](#-cáº¥u-trÃºc-dá»±-Ã¡n)
- [CÃ i Ä‘áº·t vÃ  cháº¡y dá»± Ã¡n](#-cÃ i-Ä‘áº·t-vÃ -cháº¡y-dá»±-Ã¡n)
- [Cáº¥u hÃ¬nh mÃ´i trÆ°á»ng](#-cáº¥u-hÃ¬nh-mÃ´i-trÆ°á»ng)
- [API Endpoints](#-api-endpoints)
- [Chá»©c nÄƒng chi tiáº¿t](#-chá»©c-nÄƒng-chi-tiáº¿t)

---

## âœ¨ TÃ­nh nÄƒng chÃ­nh

### ğŸ‘¨â€ğŸ’¼ Giao diá»‡n Admin
- **Dashboard tá»•ng quan**: Thá»‘ng kÃª realtime, biá»ƒu Ä‘á»“ 7 ngÃ y gáº§n nháº¥t
- **Quáº£n lÃ½ ngÆ°á»i dÃ¹ng**: Quáº£n lÃ½ bá»‡nh nhÃ¢n, bÃ¡c sÄ©, nhÃ¢n viÃªn
- **Quáº£n lÃ½ chuyÃªn khoa**: ThÃªm, sá»­a, xÃ³a cÃ¡c chuyÃªn khoa
- **Quáº£n lÃ½ bÃ¡c sÄ©**: Quáº£n lÃ½ thÃ´ng tin bÃ¡c sÄ©, chuyÃªn mÃ´n
- **Quáº£n lÃ½ phÃ²ng khÃ¡m**: Quáº£n lÃ½ cÃ¡c phÃ²ng khÃ¡m trong bá»‡nh viá»‡n
- **Quáº£n lÃ½ lá»‹ch khÃ¡m**: Táº¡o vÃ  quáº£n lÃ½ lá»‹ch khÃ¡m cá»§a bÃ¡c sÄ©
- **Quáº£n lÃ½ lÆ°á»£t Ä‘Äƒng kÃ½**: Xem, cáº­p nháº­t tráº¡ng thÃ¡i cÃ¡c lÆ°á»£t Ä‘Äƒng kÃ½ khÃ¡m
- **Quáº£n lÃ½ hÃ ng Ä‘á»£i**: Theo dÃµi vÃ  quáº£n lÃ½ hÃ ng Ä‘á»£i realtime
- **BÃ¡o cÃ¡o thá»‘ng kÃª**: BÃ¡o cÃ¡o chi tiáº¿t vá»›i biá»ƒu Ä‘á»“ trá»±c quan

### ğŸ‘¨â€âš•ï¸ Giao diá»‡n BÃ¡c sÄ©
- **Dashboard bÃ¡c sÄ©**: Tá»•ng quan lá»‹ch khÃ¡m trong ngÃ y
- **Quáº£n lÃ½ lá»‹ch khÃ¡m**: Xem vÃ  cáº­p nháº­t lá»‹ch khÃ¡m cÃ¡ nhÃ¢n
- **Quáº£n lÃ½ lÆ°á»£t khÃ¡m**: Xem danh sÃ¡ch bá»‡nh nhÃ¢n Ä‘Ã£ Ä‘áº·t lá»‹ch
- **Quáº£n lÃ½ hÃ ng Ä‘á»£i**: Gá»i sá»‘, báº¯t Ä‘áº§u khÃ¡m, hoÃ n thÃ nh
- **Há»“ sÆ¡ bÃ¡c sÄ©**: Cáº­p nháº­t thÃ´ng tin cÃ¡ nhÃ¢n

### ğŸ‘¤ Giao diá»‡n Bá»‡nh nhÃ¢n
- **Trang chá»§**: TÃ¬m kiáº¿m bÃ¡c sÄ©, chuyÃªn khoa
- **Äáº·t lá»‹ch khÃ¡m**: Äáº·t lá»‹ch khÃ¡m vá»›i bÃ¡c sÄ©
- **Lá»‹ch khÃ¡m cá»§a tÃ´i**: Xem vÃ  quáº£n lÃ½ cÃ¡c lá»‹ch Ä‘Ã£ Ä‘áº·t
- **Theo dÃµi hÃ ng Ä‘á»£i**: Xem sá»‘ thá»© tá»± vÃ  thá»i gian Æ°á»›c tÃ­nh
- **ÄÃ¡nh giÃ¡ bÃ¡c sÄ©**: ÄÃ¡nh giÃ¡ vÃ  xem Ä‘Ã¡nh giÃ¡ bÃ¡c sÄ©
- **Há»“ sÆ¡ cÃ¡ nhÃ¢n**: Quáº£n lÃ½ thÃ´ng tin cÃ¡ nhÃ¢n

### ğŸ”„ TÃ­nh nÄƒng Ä‘áº·c biá»‡t
- **Realtime Queue Management**: Quáº£n lÃ½ hÃ ng Ä‘á»£i realtime vá»›i Socket.IO
- **Smart Queue System**: Há»‡ thá»‘ng gá»i sá»‘ thÃ´ng minh
- **Statistics & Reports**: BÃ¡o cÃ¡o thá»‘ng kÃª vá»›i biá»ƒu Ä‘á»“ Recharts
- **Responsive Design**: Giao diá»‡n responsive vá»›i Tailwind CSS

---

## ğŸ›  CÃ´ng nghá»‡ sá»­ dá»¥ng

### Frontend
- **React 18.2.0** - UI Framework
- **React Router DOM 6.21.1** - Routing
- **Vite 5.0.8** - Build tool
- **Tailwind CSS 3.4.0** - Styling
- **Recharts 3.6.0** - Charts & Graphs
- **Axios 1.6.2** - HTTP Client
- **Socket.IO Client 4.6.1** - Realtime communication
- **React Icons 5.5.0** - Icons

### Backend
- **Node.js** - Runtime environment
- **Express 4.18.2** - Web framework
- **MySQL2 3.6.5** - Database driver
- **Socket.IO 4.6.1** - Realtime server
- **JWT (jsonwebtoken 9.0.2)** - Authentication
- **Bcryptjs 2.4.3** - Password hashing
- **CORS 2.8.5** - Cross-origin resource sharing
- **Dotenv 16.3.1** - Environment variables

### Database
- **MySQL** - Relational database

---

## ğŸ“ Cáº¥u trÃºc dá»± Ã¡n

```
BenhVien/
â”œâ”€â”€ BackEnd/                    # Backend API Server
â”‚   â”œâ”€â”€ config/                 # Cáº¥u hÃ¬nh
â”‚   â”‚   â””â”€â”€ database.js         # Database connection
â”‚   â”œâ”€â”€ controllers/            # Business logic
â”‚   â”‚   â”œâ”€â”€ appointments.controller.js
â”‚   â”‚   â”œâ”€â”€ auth.controller.js
â”‚   â”‚   â”œâ”€â”€ dashboard.controller.js
â”‚   â”‚   â”œâ”€â”€ doctors.controller.js
â”‚   â”‚   â”œâ”€â”€ queue.controller.js
â”‚   â”‚   â””â”€â”€ ...
â”‚   â”œâ”€â”€ database/               # Database scripts
â”‚   â”‚   â””â”€â”€ benhvien.sql        # SQL schema
â”‚   â”œâ”€â”€ middlewares/            # Middleware functions
â”‚   â”‚   â”œâ”€â”€ auth.js             # Authentication middleware
â”‚   â”‚   â””â”€â”€ error.js            # Error handling
â”‚   â”œâ”€â”€ routes/                 # API routes
â”‚   â”‚   â”œâ”€â”€ appointments.routes.js
â”‚   â”‚   â”œâ”€â”€ auth.routes.js
â”‚   â”‚   â””â”€â”€ ...
â”‚   â”œâ”€â”€ socketHandlers/         # Socket.IO handlers
â”‚   â”‚   â””â”€â”€ queue.handler.js
â”‚   â”œâ”€â”€ utils/                  # Utility functions
â”‚   â”‚   â”œâ”€â”€ jwt.js
â”‚   â”‚   â””â”€â”€ validation.js
â”‚   â”œâ”€â”€ app.js                  # Express app setup
â”‚   â”œâ”€â”€ server.js               # Server entry point
â”‚   â””â”€â”€ package.json
â”‚
â”œâ”€â”€ FrontEnd/                   # Frontend React App
â”‚   â”œâ”€â”€ public/                 # Static files
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ Admin/              # Admin pages
â”‚   â”‚   â”‚   â”œâ”€â”€ Dashboard.jsx
â”‚   â”‚   â”‚   â”œâ”€â”€ AdminAppointmentList.jsx
â”‚   â”‚   â”‚   â”œâ”€â”€ AdminReports.jsx
â”‚   â”‚   â”‚   â””â”€â”€ ...
â”‚   â”‚   â”œâ”€â”€ Doctor/             # Doctor pages
â”‚   â”‚   â”‚   â”œâ”€â”€ DoctorDashboard.jsx
â”‚   â”‚   â”‚   â”œâ”€â”€ DoctorQueue.jsx
â”‚   â”‚   â”‚   â””â”€â”€ ...
â”‚   â”‚   â”œâ”€â”€ Patient/             # Patient pages
â”‚   â”‚   â”‚   â”œâ”€â”€ HomePage.jsx
â”‚   â”‚   â”‚   â”œâ”€â”€ BookAppointment.jsx
â”‚   â”‚   â”‚   â”œâ”€â”€ MyAppointments.jsx
â”‚   â”‚   â”‚   â””â”€â”€ ...
â”‚   â”‚   â”œâ”€â”€ Auth/                # Authentication pages
â”‚   â”‚   â”‚   â”œâ”€â”€ Login.jsx
â”‚   â”‚   â”‚   â””â”€â”€ Register.jsx
â”‚   â”‚   â”œâ”€â”€ components/          # Reusable components
â”‚   â”‚   â”œâ”€â”€ services/            # API services
â”‚   â”‚   â”‚   â”œâ”€â”€ api.js
â”‚   â”‚   â”‚   â”œâ”€â”€ authService.js
â”‚   â”‚   â”‚   â”œâ”€â”€ appointmentService.js
â”‚   â”‚   â”‚   â””â”€â”€ ...
â”‚   â”‚   â”œâ”€â”€ App.jsx              # Main app component
â”‚   â”‚   â””â”€â”€ main.jsx            # Entry point
â”‚   â”œâ”€â”€ package.json
â”‚   â””â”€â”€ vite.config.js
â”‚
â””â”€â”€ README.md                    # File nÃ y
```

---

## ğŸš€ CÃ i Ä‘áº·t vÃ  cháº¡y dá»± Ã¡n

### YÃªu cáº§u há»‡ thá»‘ng
- **Node.js** >= 16.x
- **MySQL** >= 8.0
- **npm** hoáº·c **yarn**

### BÆ°á»›c 1: Clone repository
```bash
git clone https://github.com/tambl2004/hospital-queue-online.git


### BÆ°á»›c 2: CÃ i Ä‘áº·t Backend
```bash
cd BackEnd
npm install
```

### BÆ°á»›c 3: CÃ i Ä‘áº·t Frontend
```bash
cd ../FrontEnd
npm install
```

### BÆ°á»›c 4: Cáº¥u hÃ¬nh Database
1. Táº¡o database MySQL:
```sql
CREATE DATABASE benhvien CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;
```

2. Import schema:
```bash
mysql -u root -p benhvien < BackEnd/database/benhvien.sql
```

### BÆ°á»›c 5: Cáº¥u hÃ¬nh mÃ´i trÆ°á»ng

Táº¡o file `.env` trong thÆ° má»¥c `BackEnd/`:
```env
# Database
DB_HOST=localhost
DB_USER=root
DB_PASSWORD=
DB_NAME=benhvien

# Server
PORT=5000
CLIENT_URL=http://localhost:5173

# JWT
JWT_SECRET=your_jwt_secret_key_here
JWT_EXPIRE=7d
```

### BÆ°á»›c 6: Cháº¡y Backend
```bash
cd BackEnd
npm start
```

Backend sáº½ cháº¡y táº¡i: `http://localhost:5000`

### BÆ°á»›c 7: Cháº¡y Frontend
```bash
cd FrontEnd
npm run dev
```

Frontend sáº½ cháº¡y táº¡i: `http://localhost:5173`

---

## âš™ï¸ Cáº¥u hÃ¬nh mÃ´i trÆ°á»ng

### Backend Environment Variables

| Biáº¿n | MÃ´ táº£ | Máº·c Ä‘á»‹nh |
|------|-------|----------|
| `DB_HOST` | MySQL host | `localhost` |
| `DB_USER` | MySQL username | `root` |
| `DB_PASSWORD` | MySQL password | `` |
| `DB_NAME` | Database name | `benhvien` |
| `PORT` | Server port | `5000` |
| `CLIENT_URL` | Frontend URL | `http://localhost:5173` |
| `JWT_SECRET` | JWT secret key | (báº¯t buá»™c) |
| `JWT_EXPIRE` | JWT expiration | `7d` |

---

## ğŸ”Œ API Endpoints

### Authentication
- `POST /api/auth/register` - ÄÄƒng kÃ½
- `POST /api/auth/login` - ÄÄƒng nháº­p
- `POST /api/auth/logout` - ÄÄƒng xuáº¥t
- `GET /api/auth/me` - Láº¥y thÃ´ng tin user hiá»‡n táº¡i

### Appointments
- `GET /api/appointments` - Láº¥y danh sÃ¡ch appointments
- `GET /api/appointments/:id` - Láº¥y chi tiáº¿t appointment
- `POST /api/appointments` - Táº¡o appointment má»›i
- `PATCH /api/appointments/:id/status` - Cáº­p nháº­t tráº¡ng thÃ¡i
- `PATCH /api/appointments/:id/cancel` - Há»§y appointment

### Queue Management
- `GET /api/queue/:doctorId/:date` - Láº¥y tráº¡ng thÃ¡i hÃ ng Ä‘á»£i
- `POST /api/queue/call-next` - Gá»i sá»‘ tiáº¿p theo
- `POST /api/queue/start` - Báº¯t Ä‘áº§u khÃ¡m
- `POST /api/queue/complete` - HoÃ n thÃ nh khÃ¡m
- `POST /api/queue/skip` - Bá» qua

### Admin
- `GET /api/admin/dashboard` - Dashboard data
- `GET /api/admin/reports` - BÃ¡o cÃ¡o thá»‘ng kÃª
- `GET /api/admin/users` - Quáº£n lÃ½ users
- `GET /api/admin/doctors` - Quáº£n lÃ½ doctors
- `GET /api/admin/departments` - Quáº£n lÃ½ departments
- `GET /api/admin/rooms` - Quáº£n lÃ½ rooms
- `GET /api/admin/schedules` - Quáº£n lÃ½ schedules

### Doctor
- `GET /api/doctor/dashboard` - Dashboard bÃ¡c sÄ©
- `GET /api/doctor/appointments` - Lá»‹ch khÃ¡m cá»§a bÃ¡c sÄ©
- `GET /api/doctor/schedule` - Lá»‹ch lÃ m viá»‡c

---

## ğŸ“± Chá»©c nÄƒng chi tiáº¿t

### 1. Quáº£n lÃ½ Appointments

#### Tráº¡ng thÃ¡i Appointments
- **WAITING**: Äang chá» gá»i
- **CALLED**: ÄÃ£ gá»i
- **IN_PROGRESS**: Äang khÃ¡m
- **DONE**: HoÃ n thÃ nh
- **CANCELLED**: ÄÃ£ há»§y
- **SKIPPED**: Bá» qua

#### State Machine Transitions
```
WAITING â†’ CALLED (Gá»i sá»‘)
WAITING â†’ CANCELLED (Há»§y lá»‹ch)
CALLED â†’ IN_PROGRESS (Báº¯t Ä‘áº§u khÃ¡m)
CALLED â†’ SKIPPED (Bá» qua)
IN_PROGRESS â†’ DONE (HoÃ n thÃ nh)
SKIPPED â†’ CALLED (Gá»i láº¡i)
```

### 2. Há»‡ thá»‘ng HÃ ng Ä‘á»£i (Queue)

- **Tá»± Ä‘á»™ng phÃ¢n sá»‘ thá»© tá»±** khi bá»‡nh nhÃ¢n Ä‘áº·t lá»‹ch
- **Realtime updates** qua Socket.IO
- **Æ¯á»›c tÃ­nh thá»i gian chá»** dá»±a trÃªn lá»‹ch sá»­
- **Gá»i sá»‘ tá»± Ä‘á»™ng** vÃ  thÃ´ng bÃ¡o realtime

### 3. Thá»‘ng kÃª vÃ  BÃ¡o cÃ¡o

- **Dashboard tá»•ng quan**: Thá»‘ng kÃª realtime
- **Biá»ƒu Ä‘á»“ 7 ngÃ y gáº§n nháº¥t**: Bar chart vá»›i Recharts
- **BÃ¡o cÃ¡o chi tiáº¿t**: 
  - Biá»ƒu Ä‘á»“ theo ngÃ y
  - PhÃ¢n bá»• theo tráº¡ng thÃ¡i (Pie chart)
  - Top bÃ¡c sÄ©
  - Top chuyÃªn khoa

### 4. Quáº£n lÃ½ Lá»‹ch khÃ¡m

- **Táº¡o lá»‹ch khÃ¡m**: BÃ¡c sÄ© táº¡o lá»‹ch theo ngÃ y
- **Quáº£n lÃ½ slot**: ThÃªm, sá»­a, xÃ³a cÃ¡c slot khÃ¡m
- **Äáº·t lá»‹ch**: Bá»‡nh nhÃ¢n chá»n slot phÃ¹ há»£p
- **Tá»± Ä‘á»™ng cáº­p nháº­t**: Cáº­p nháº­t sá»‘ lÆ°á»£ng cÃ²n láº¡i

---

## ğŸ‘¥ Vai trÃ² vÃ  Quyá»n

### Admin
- ToÃ n quyá»n quáº£n lÃ½ há»‡ thá»‘ng
- Xem táº¥t cáº£ appointments
- Quáº£n lÃ½ users, doctors, departments, rooms
- Xem bÃ¡o cÃ¡o vÃ  thá»‘ng kÃª

### Doctor
- Xem appointments cá»§a chÃ­nh mÃ¬nh
- Quáº£n lÃ½ lá»‹ch khÃ¡m cÃ¡ nhÃ¢n
- Quáº£n lÃ½ hÃ ng Ä‘á»£i
- Cáº­p nháº­t tráº¡ng thÃ¡i khÃ¡m

### Patient
- Äáº·t lá»‹ch khÃ¡m
- Xem appointments cá»§a chÃ­nh mÃ¬nh
- Theo dÃµi hÃ ng Ä‘á»£i
- ÄÃ¡nh giÃ¡ bÃ¡c sÄ©

---

## ğŸ” Authentication

Há»‡ thá»‘ng sá»­ dá»¥ng **JWT (JSON Web Token)** Ä‘á»ƒ xÃ¡c thá»±c:
- Token Ä‘Æ°á»£c lÆ°u trong localStorage
- Token cÃ³ thá»i háº¡n (máº·c Ä‘á»‹nh 7 ngÃ y)
- Má»—i request cáº§n gá»­i token trong header: `Authorization: Bearer <token>`

---

## ğŸ“Š Database Schema

### CÃ¡c báº£ng chÃ­nh:
- `users` - ThÃ´ng tin ngÆ°á»i dÃ¹ng
- `doctors` - ThÃ´ng tin bÃ¡c sÄ©
- `departments` - ChuyÃªn khoa
- `rooms` - PhÃ²ng khÃ¡m
- `doctor_schedules` - Lá»‹ch khÃ¡m cá»§a bÃ¡c sÄ©
- `appointments` - LÆ°á»£t Ä‘Äƒng kÃ½ khÃ¡m
- `queue_numbers` - Sá»‘ thá»© tá»± hÃ ng Ä‘á»£i
- `ratings` - ÄÃ¡nh giÃ¡ bÃ¡c sÄ©

---

## ğŸ› Troubleshooting

### Lá»—i káº¿t ná»‘i Database
- Kiá»ƒm tra MySQL Ä‘Ã£ cháº¡y chÆ°a
- Kiá»ƒm tra thÃ´ng tin trong file `.env`
- Kiá»ƒm tra database Ä‘Ã£ Ä‘Æ°á»£c táº¡o chÆ°a

### Lá»—i CORS
- Kiá»ƒm tra `CLIENT_URL` trong `.env`
- Äáº£m báº£o frontend vÃ  backend cháº¡y Ä‘Ãºng port

### Lá»—i JWT
- Kiá»ƒm tra `JWT_SECRET` Ä‘Ã£ Ä‘Æ°á»£c set chÆ°a
- Kiá»ƒm tra token cÃ³ háº¿t háº¡n khÃ´ng

---

## ğŸ“ Ghi chÃº

- Äáº£m báº£o MySQL Ä‘Ã£ Ä‘Æ°á»£c cÃ i Ä‘áº·t vÃ  cháº¡y trÆ°á»›c khi start backend
- Port máº·c Ä‘á»‹nh: Backend (5000), Frontend (5173)
- Database charset: `utf8mb4` Ä‘á»ƒ há»— trá»£ tiáº¿ng Viá»‡t

